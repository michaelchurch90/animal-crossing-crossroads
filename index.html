<!DOCTYPE html>
<html>

<head>
    <title>Animal Crossing</title>
    <link rel="stylesheet" href="styles.css">

    <!-- development version, includes helpful console warnings -->
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>

    <!-- production version, optimized for size and speed -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/vue"></script> -->
</head>



<body>

    <h1>Animal Crossing</h1>

    <div id="app">
        <h2>Availiable</h2>
        <fish-row v-for="(fish, name) in fishes" class="fish-container" v-bind:key="name"
            v-on:click.native="completeFish(name)" v-bind:fish="fish" v-bind:name="name">
        </fish-row>

        <h2>Completed</h2>
        <fish-row v-for="(fish, name) in completedFish" class="fish-container" v-bind:key="name"
            v-on:click.native="unCompleteFish(name)" v-bind:fish="fish" v-bind:name="name">
        </fish-row>
    </div>



    <script>
        var app = new Vue({
            el: '#app',
            data: {
                monthArray: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
                fishes: {},
                completedFish: {}
            },
            methods: {
                completeFish: function (fishKey) {
                    const fish = this.fishes[fishKey];
                    Vue.delete(this.fishes, fishKey);
                    console.log(fish);
                    this.completedFish = { ...this.completedFish, [fishKey]: fish };
                },
                unCompleteFish: function (fishKey) {
                    const fish = this.completedFish[fishKey];
                    Vue.delete(this.completedFish, fishKey);
                    console.log(fish);
                    this.fishes = { ...this.fishes, [fishKey]: fish };
                }
            }
        })

        Vue.component('fish-row', {
            props: ['fish', 'name'],
            data: () => ({
                monthArray: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
            })
            ,
            /*html*/
            template: `
            <div>
            <label>{{fish.name["name-USen"]}}</label>
            <img v-bind:src="fish.icon_uri" />
            <div class="fish-info">
                <label class="availability">Availability</label>
                <p class="availability">{{fish.availability.isAllDay ? "All Day": fish.availability.time}}</p>

                <label class="location">Location</label>
                <p class="location">{{fish.availability.location}}</p>

                <label class="rarity">Rarity</label>
                <p class="rarity">{{fish.availability.rarity}}</p>

                <label class="shadow" >Shadow</label>
                <p class="shadow">{{fish.shadow}}</p>
            </div>
            <div class="months">
                <div v-for="i in 12">
                    <div class="enabled-month month" v-if="fish.availability['month-array-northern'].includes(i)">
                        {{monthArray[i-1]}}
                    </div>
                    <div class="disabled-month month" v-else>
                        {{monthArray[i-1]}}
                    </div>
                </div>
            </div>
            </div>
            `
        })
        async function populateFish() {
            const fish = await fetch('https://acnhapi.com/v1/fish')
                .then(response => response.json())
            app.fishes = fish;
        }

        populateFish()
    </script>


</body>

</html>